<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
</head>

<body>
<canvas id="canvas" width="500" height="500" style="background:#000009"></canvas>
<p id="log"></p>
<script src="js/utils.js"></script>
<script src="js/ball.js"></script>
<script src="js/arrow.js"></script>
<script>
window.onload=function(){
	var canvas=document.getElementById("canvas"),
	context=canvas.getContext("2d"),
	centerX=canvas.width/2,
	centerY=canvas.height/2;
	
	/* 
	var ball =new Ball();
	 	ball.x=canvas.width/2;
		ball.y=canvas.height/2;
	var vx=1,vy=1;//定义速度
	var speed=5,angle=30;
	(function drawFrame(){
		window.requestAnimationFrame(drawFrame,canvas);
		context.clearRect(0,0,canvas.width,canvas.height);
		//将速度分解到X轴和Y轴，注意这里用的是弧度制，要乘上Math.PI/180
		var vx=Math.cos(angle*Math.PI/180)*speed;
		var vy=Math.sin(angle*Math.PI/180)*speed;
		ball.x+=vx;
		ball.y+=vy;
		ball.draw(context)
		})()*/
		
	//箭头跟随	
	var mouse=utils.captureMouse(canvas);
	var arrow=new Arrow();
	arrow.x=canvas.width/2;
	arrow.y=canvas.height/2;
	var angle=0,speed=2;
	(function drawFrame(){
		window.requestAnimationFrame(drawFrame,canvas);
		context.clearRect(0,0,canvas.width,canvas.height);
		var dx=mouse.x-arrow.x;
		var dy=mouse.y-arrow.y;
		angle=Math.atan2(dy,dx);
		arrow.rotation=angle;
		var vx=Math.cos(angle)*speed;
		var vy=Math.sin(angle)*speed;
		arrow.x+=vx;
		arrow.y+=vy;
		arrow.draw(context);
		})()
		/*var arrow=new Arrow();
		arrow.x=canvas.width/2;
		arrow.y=canvas.height/2;
		var vr=30,speed=2;
		(function drawFrame(){
			window.requestAnimationFrame(drawFrame,canvas);
			context.clearRect(0,0,canvas.width,canvas.height);
			arrow.rotation=vr*Math.PI/180;
			arrow.x+=Math.cos(arrow.rotation)*speed;
			arrow.y+=Math.sin(arrow.rotation)*speed;
			arrow.draw(context);
			})()*/
	}
</script>
</body>
</html>

